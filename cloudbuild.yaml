# Create the new instance template
steps:
- name: 'gcr.io/cloud-builders/docker'
  id: create-instance-template
  args:
    - compute
    - instance-templates
    - create
    - cloud-build-instance-template
    - --custom-cpu=1
    - --custom-memory=2GB
    - --boot-disk-size=10GB
    - --region=us-central1
    - --subnet=default
    - --tags=allow-hc-and-proxy,allow-ssh
    - --container-image
    - us-central1-docker.pkg.dev/devops-386105/python-repo/python-image:latest

- name: 'gcr.io/cloud-builders/gcloud'
  entrypoint: 'bash'
  args:
    - '-c'
    - |
      gcloud compute instance-groups managed create cloudbuild-mig --template cloud-build-instance-template --size 1 --region us-central1

options:
  logging: CLOUD_LOGGING_ONLY





